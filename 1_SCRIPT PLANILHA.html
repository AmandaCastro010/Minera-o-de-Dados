<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.3px 'Helvetica Neue'; color: #8f000f; -webkit-text-stroke: #8f000f; background-color: #f4f5f7}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.3px 'Helvetica Neue'; color: #3c3f43; -webkit-text-stroke: #3c3f43; background-color: #f4f5f7}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.7px Arial; -webkit-text-stroke: #000000; background-color: #f4f5f7; min-height: 16.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.3px 'Helvetica Neue'; color: #131315; -webkit-text-stroke: #131315; background-color: #f4f5f7}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.3px 'Helvetica Neue'; color: #232526; -webkit-text-stroke: #232526; background-color: #f4f5f7}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.7px Arial; -webkit-text-stroke: #000000; min-height: 16.0px}
    span.s1 {font-kerning: none; color: #112d9e; -webkit-text-stroke: 0px #112d9e}
    span.s2 {font-kerning: none; color: #232526; -webkit-text-stroke: 0px #232526}
    span.s3 {font-kerning: none; color: #a90060; -webkit-text-stroke: 0px #a90060}
    span.s4 {font-kerning: none}
    span.s5 {font-kerning: none; color: #8f000f; -webkit-text-stroke: 0px #8f000f}
    span.s6 {font-kerning: none; color: #131315; -webkit-text-stroke: 0px #131315}
    span.s7 {font-kerning: none; color: #14606b; -webkit-text-stroke: 0px #14606b}
  </style>
</head>
<body>
<p class="p1"><span class="s1">const</span><span class="s2"> </span><span class="s3">API_KEY</span><span class="s2"> = </span><span class="s4">‘add key’</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s1">const</span><span class="s2"> </span><span class="s3">VIDEO_ID</span><span class="s2"> = </span><span class="s5">'_NzqP0jmk3o'</span><span class="s2">; </span><span class="s4">// ID do vídeo</span></p>
<p class="p1"><span class="s1">const</span><span class="s2"> </span><span class="s3">DATE_CUTOFF</span><span class="s2"> = </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Date</span><span class="s2">(</span><span class="s4">'2024-11-07T00:00:00Z'</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p4"><span class="s1">function</span><span class="s2"> </span><span class="s4">getYoutubeComments</span><span class="s2">() {</span></p>
<p class="p4"><span class="s2"> </span><span class="s1">const</span><span class="s2"> </span><span class="s4">sheet</span><span class="s2"> = </span><span class="s3">SpreadsheetApp</span><span class="s2">.</span><span class="s4">getActiveSpreadsheet</span><span class="s2">().</span><span class="s4">getActiveSheet</span><span class="s2">();</span></p>
<p class="p4"><span class="s2"> </span><span class="s4">sheet</span><span class="s2">.</span><span class="s4">clear</span><span class="s2">();</span></p>
<p class="p1"><span class="s2"> </span><span class="s6">sheet</span><span class="s2">.</span><span class="s6">appendRow</span><span class="s2">([</span><span class="s4">'Autor'</span><span class="s2">, </span><span class="s4">'Comentário'</span><span class="s2">, </span><span class="s4">'Data'</span><span class="s2">, </span><span class="s4">'Likes'</span><span class="s2">]);</span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p4"><span class="s2"> </span><span class="s1">let</span><span class="s2"> </span><span class="s4">nextPageToken</span><span class="s2"> = </span><span class="s5">''</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"> </span><span class="s1">const</span><span class="s2"> </span><span class="s4">maxResults</span><span class="s2"> = </span><span class="s7">100</span><span class="s2">;</span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p5"><span class="s4"> </span><span class="s1">do</span><span class="s4"> {</span></p>
<p class="p1"><span class="s2">   </span><span class="s1">const</span><span class="s2"> </span><span class="s6">url</span><span class="s2"> = </span><span class="s4">`https://www.googleapis.com/youtube/v3/commentThreads?key=</span><span class="s2">${</span><span class="s3">API_KEY</span><span class="s2">}</span><span class="s4">&amp;textFormat=plainText&amp;part=snippet&amp;videoId=</span><span class="s2">${</span><span class="s3">VIDEO_ID</span><span class="s2">}</span><span class="s4">&amp;maxResults=</span><span class="s2">${</span><span class="s6">maxResults</span><span class="s2">}</span><span class="s4">&amp;pageToken=</span><span class="s2">${</span><span class="s6">nextPageToken</span><span class="s2">}</span><span class="s4">`</span><span class="s2">;</span></p>
<p class="p4"><span class="s2">   </span><span class="s1">const</span><span class="s2"> </span><span class="s4">response</span><span class="s2"> = </span><span class="s3">UrlFetchApp</span><span class="s2">.</span><span class="s4">fetch</span><span class="s2">(</span><span class="s4">url</span><span class="s2">);</span></p>
<p class="p4"><span class="s2">   </span><span class="s1">const</span><span class="s2"> </span><span class="s4">data</span><span class="s2"> = </span><span class="s3">JSON</span><span class="s2">.</span><span class="s4">parse</span><span class="s2">(</span><span class="s4">response</span><span class="s2">.</span><span class="s4">getContentText</span><span class="s2">());</span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p4"><span class="s2">   </span><span class="s1">const</span><span class="s2"> </span><span class="s4">comments</span><span class="s2"> = </span><span class="s4">data</span><span class="s2">.</span><span class="s4">items</span><span class="s2">;</span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p5"><span class="s4">   </span><span class="s1">for</span><span class="s4"> (</span><span class="s1">let</span><span class="s4"> </span><span class="s6">i</span><span class="s4"> = </span><span class="s7">0</span><span class="s4">; </span><span class="s6">i</span><span class="s4"> &lt; </span><span class="s6">comments</span><span class="s4">.</span><span class="s6">length</span><span class="s4">; </span><span class="s6">i</span><span class="s4">++) {</span></p>
<p class="p4"><span class="s2">     </span><span class="s1">const</span><span class="s2"> </span><span class="s4">comment</span><span class="s2"> = </span><span class="s4">comments</span><span class="s2">[</span><span class="s4">i</span><span class="s2">].</span><span class="s4">snippet</span><span class="s2">.</span><span class="s4">topLevelComment</span><span class="s2">.</span><span class="s4">snippet</span><span class="s2">;</span></p>
<p class="p4"><span class="s2">     </span><span class="s1">const</span><span class="s2"> </span><span class="s4">publishedDate</span><span class="s2"> = </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Date</span><span class="s2">(</span><span class="s4">comment</span><span class="s2">.</span><span class="s4">publishedAt</span><span class="s2">);</span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p5"><span class="s4">   <span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2">     </span><span class="s1">if</span><span class="s2"> (</span><span class="s4">publishedDate</span><span class="s2"> &lt; </span><span class="s3">DATE_CUTOFF</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2">       </span><span class="s4">sheet</span><span class="s2">.</span><span class="s4">appendRow</span><span class="s2">([</span></p>
<p class="p4"><span class="s2">         </span><span class="s4">comment</span><span class="s2">.</span><span class="s4">authorDisplayName</span><span class="s2">,</span></p>
<p class="p4"><span class="s2">         </span><span class="s4">comment</span><span class="s2">.</span><span class="s4">textDisplay</span><span class="s2">,</span></p>
<p class="p4"><span class="s2">         </span><span class="s4">comment</span><span class="s2">.</span><span class="s4">publishedAt</span><span class="s2">,</span></p>
<p class="p4"><span class="s2">         </span><span class="s4">comment</span><span class="s2">.</span><span class="s4">likeCount</span></p>
<p class="p5"><span class="s4">       ]);</span></p>
<p class="p5"><span class="s4">     }</span></p>
<p class="p5"><span class="s4">   }</span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p4"><span class="s2">   </span><span class="s4">nextPageToken</span><span class="s2"> = </span><span class="s4">data</span><span class="s2">.</span><span class="s4">nextPageToken</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"> } </span><span class="s1">while</span><span class="s2"> (</span><span class="s4">nextPageToken</span><span class="s2">);</span></p>
<p class="p5"><span class="s4">}</span></p>
<p class="p3"><span class="s4"></span><br></p>
<p class="p6"><span class="s4"></span><br></p>
</body>
</html>
